<html>
  <head>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <link href="https://fonts.googleapis.com/css?family=Roboto+Slab" rel="stylesheet">
    <style>
      body{
        background-color: #ecf0f1;
        font-family: 'Roboto Slab', serif;
        overflow-x:hidden;
      }
      #c{
        overflow-x:hidden;
      }
      .a{
        fill:#C8D0CE;
      }
      .light-off{
        fill:#F6F6F6;
        stroke:#E8EDEA;
      }
      .col-md-4{
        padding: 20px 20px 20px 20px;
      }
      .rainbow {
        line-height: 1.3;
        background-image: -webkit-gradient( linear, left top, right top, color-stop(0, #ff4427), color-stop(0.15, #ff4427), color-stop(0.3, #ff6b49), color-stop(0.45, #ff811e), color-stop(0.6, #ffd43e), color-stop(0.75, #fff746), color-stop(0.9, #eeff6f), color-stop(1, #d5ff3f) );
        background-image: gradient( linear, left top, right top, color-stop(0, #ff4130), color-stop(0.15, #ff6d35), color-stop(0.3, #ff6b49), color-stop(0.45, #ff811e), color-stop(0.6, #ffd43e), color-stop(0.75, #fff746), color-stop(0.9, #eeff6f), color-stop(1, #d5ff3f) );
        color:transparent;
        -webkit-background-clip: text;
        background-clip: text;
      }
    </style>
  </head>
  <body onload=resizeSVG() onresize=resizeSVG()>
    <div class="container">
      <header class="row" style="background-color: #3D3F41; margin-top: 5px; border-radius: 10px; text-align: center; padding-bottom: 10px; margin-bottom: 20px; color:#ecf0f1;">
        <div style="width: 300px; display: block; margin: auto;" >
          <span><h1 class="rainbow center">Chroma Light</h1></span>
        </div>
      </header>
      <div id="content-status" class="row"></div>
      <div id="content" class="row">
        <div class="col-xs-4 center">
          <a id="btn_led_1" role="button" href="#colorWheelDrop" aria-expanded="false" aria-controls="colorWheelDrop" style="text-decoration: none;">
            <svg xmlns="http://www.w3.org/2000/svg" style="display: block; margin: auto;" height="300" viewBox="0 0 338 513">
              <g class="led" fill="none">
                <g class="lightbulb" transform="translate(1 1)">
                  <path id="bulb-1" class="light-off" d="M334.94 152.72C326.1 73.27 262.51 9.71 183.02 0.88 177.72 0.88 173.3 0 168 0 162.7 0 158.28 0 152.98 0.88 73.49 9.71 9.9 74.15 1.06 152.72 -5.12 209.21 16.08 260.41 53.18 295.72 74.37 316.03 92.04 342.51 97.34 370.76L238.66 370.76C243.96 342.51 261.63 316.03 282.82 295.72 319.92 260.41 341.12 209.21 334.94 152.72"/>
                  <polygon points="97.28 476.69 238.53 476.69 238.53 370.76 97.28 370.76" fill="#E8EDEA"/>
                  <path d="M181.15 512L154.66 512C146.72 512 138.77 508.47 133.48 501.41L114.94 476.69 220.87 476.69 202.33 501.41C197.04 508.47 189.09 512 181.15 512" class="a"/>
                  <path d="M159.08 414.9C164.37 414.9 167.91 411.37 167.91 406.07 167.91 400.77 164.37 397.24 159.08 397.24L97.28 397.24 97.28 414.9 159.08 414.9" class="a"/>
                  <path d="M132.6 450.21C137.89 450.21 141.42 446.68 141.42 441.38 141.42 436.08 137.89 432.55 132.6 432.55L97.28 432.55 97.28 450.21 132.6 450.21" class="a"/>
                  <path d="M238.53 397.24L203.22 397.24C197.92 397.24 194.39 400.77 194.39 406.07 194.39 411.37 197.92 414.9 203.22 414.9L238.53 414.9 238.53 397.24" class="a"/>
                  <path d="M176.73 432.55C171.44 432.55 167.91 436.08 167.91 441.38 167.91 446.68 171.44 450.21 176.73 450.21L238.53 450.21 238.53 432.55 176.73 432.55" class="a"/>
                </g>
              </g>
            </svg>
          </a>
        </div>
        <div class="col-xs-4 center">
          <a id="btn_led_2" role="button" href="#colorWheelDrop" aria-expanded="false" aria-controls="colorWheelDrop" style="text-decoration: none;">
            <svg xmlns="http://www.w3.org/2000/svg" style="display: block; margin: auto;" height="300" viewBox="0 0 338 513">
              <g class="led" fill="none">
                <g class="lightbulb" transform="translate(1 1)">
                  <path id="bulb-2" class="light-off" d="M334.94 152.72C326.1 73.27 262.51 9.71 183.02 0.88 177.72 0.88 173.3 0 168 0 162.7 0 158.28 0 152.98 0.88 73.49 9.71 9.9 74.15 1.06 152.72 -5.12 209.21 16.08 260.41 53.18 295.72 74.37 316.03 92.04 342.51 97.34 370.76L238.66 370.76C243.96 342.51 261.63 316.03 282.82 295.72 319.92 260.41 341.12 209.21 334.94 152.72"/>
                  <polygon points="97.28 476.69 238.53 476.69 238.53 370.76 97.28 370.76" fill="#E8EDEA"/>
                  <path d="M181.15 512L154.66 512C146.72 512 138.77 508.47 133.48 501.41L114.94 476.69 220.87 476.69 202.33 501.41C197.04 508.47 189.09 512 181.15 512" class="a"/>
                  <path d="M159.08 414.9C164.37 414.9 167.91 411.37 167.91 406.07 167.91 400.77 164.37 397.24 159.08 397.24L97.28 397.24 97.28 414.9 159.08 414.9" class="a"/>
                  <path d="M132.6 450.21C137.89 450.21 141.42 446.68 141.42 441.38 141.42 436.08 137.89 432.55 132.6 432.55L97.28 432.55 97.28 450.21 132.6 450.21" class="a"/>
                  <path d="M238.53 397.24L203.22 397.24C197.92 397.24 194.39 400.77 194.39 406.07 194.39 411.37 197.92 414.9 203.22 414.9L238.53 414.9 238.53 397.24" class="a"/>
                  <path d="M176.73 432.55C171.44 432.55 167.91 436.08 167.91 441.38 167.91 446.68 171.44 450.21 176.73 450.21L238.53 450.21 238.53 432.55 176.73 432.55" class="a"/>
                </g>
              </g>
            </svg>
          </a>
        </div>
        <div class="col-xs-4 center">
          <a id="btn_led_3" role="button" href="#colorWheelDrop" aria-expanded="false" aria-controls="colorWheelDrop" style="text-decoration: none;">
            <svg xmlns="http://www.w3.org/2000/svg" style="display: block; margin: auto;" height="300" viewBox="0 0 338 513">
              <g class="led" fill="none">
                <g class="lightbulb" transform="translate(1 1)">
                  <path id="bulb-3" class="light-off" d="M334.94 152.72C326.1 73.27 262.51 9.71 183.02 0.88 177.72 0.88 173.3 0 168 0 162.7 0 158.28 0 152.98 0.88 73.49 9.71 9.9 74.15 1.06 152.72 -5.12 209.21 16.08 260.41 53.18 295.72 74.37 316.03 92.04 342.51 97.34 370.76L238.66 370.76C243.96 342.51 261.63 316.03 282.82 295.72 319.92 260.41 341.12 209.21 334.94 152.72"/>
                  <polygon points="97.28 476.69 238.53 476.69 238.53 370.76 97.28 370.76" fill="#E8EDEA"/>
                  <path d="M181.15 512L154.66 512C146.72 512 138.77 508.47 133.48 501.41L114.94 476.69 220.87 476.69 202.33 501.41C197.04 508.47 189.09 512 181.15 512" class="a"/>
                  <path d="M159.08 414.9C164.37 414.9 167.91 411.37 167.91 406.07 167.91 400.77 164.37 397.24 159.08 397.24L97.28 397.24 97.28 414.9 159.08 414.9" class="a"/>
                  <path d="M132.6 450.21C137.89 450.21 141.42 446.68 141.42 441.38 141.42 436.08 137.89 432.55 132.6 432.55L97.28 432.55 97.28 450.21 132.6 450.21" class="a"/>
                  <path d="M238.53 397.24L203.22 397.24C197.92 397.24 194.39 400.77 194.39 406.07 194.39 411.37 197.92 414.9 203.22 414.9L238.53 414.9 238.53 397.24" class="a"/>
                  <path d="M176.73 432.55C171.44 432.55 167.91 436.08 167.91 441.38 167.91 446.68 171.44 450.21 176.73 450.21L238.53 450.21 238.53 432.55 176.73 432.55" class="a"/>
                </g>
              </g>
            </svg>
          </a>
        </div>
      </div>
    </div>
    <div class="collapse" id="colorWheelDrop">
      <div class="well">
        <h3 id="light-name-id" style="text-align: center;">Light: None</h3>
        <button id="light-power" type="button" class="btn btn-success" onclick="toggleLEDPower()">Turn Off</button>
        <p>Click and Drag along the color wheel with your mouse or tap on the circle (if on mobile) to change the light color.</p>
        <canvas id="c"></canvas>
    		<script>
    			var b = document.getElementById('colorWheelDrop');
    			var c = document.getElementById('c');
    			var a = c.getContext('2d');
    			document.body.clientWidth; // fix bug in webkit: http://qfox.nl/weblog/218
    		</script>
      </div>
    </div>
    <script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script>
      //Get from Node Server the color to set the bulbs.
      var socket = io();

      socket.on('led status', function(ledMap){
        console.log("NODE to HTML >>>>>> Recieved ledmap");
        for (key in ledMap){
            rgbJoin = ledMap[key].join();
            document.getElementById(key).setAttribute('style','fill: rgb('+ rgbJoin +');');


        }
        document.getElementById('content').style.removeProperty('display')
        document.getElementById('content-status').innerHTML = "";


      });

      socket.on('disconnect', function(){
          var content = document.getElementById('content-status');
          document.getElementById('content').style.setProperty('display','none');
          content.innerHTML = "<div class='alert alert-danger' style='text-align:center;'><h2>Disconnected State</h2>Controls have been disabled.</div>";
      });

      socket.on('disconnect site', function(){
          var content = document.getElementById('content-status');
          document.getElementById('content').style.setProperty('display','none');
          content.innerHTML = "<div class='alert alert-danger' style='text-align:center;'><h2>Disconnected State</h2>Controls have been disabled.</div>";
      });


    </script>

    <script>
      //Detect what bulb was selected and send the data over to the color wheel funcitons.
      var bulbClicked;
      var bCount = 0;
      $('#bulb-1').on('click',function(){
        if(bCount == 0){
          $('.collapse').collapse('show');
          getLEDDdata(document.getElementById('bulb-1'));
          bCount = 1;
        }
        else if(bCount == 1){
          if(bulbClicked == 'bulb-1'){
            $('.collapse').collapse('hide');
            bCount = 0;
          }
          else{
            getLEDDdata(document.getElementById('bulb-1'));
          }
        }
        bulbClicked = 'bulb-1';
      });
      $('#bulb-2').on('click',function(){
        if(bCount == 0){
          $('.collapse').collapse('show');
          getLEDDdata(document.getElementById('bulb-2'));
          bCount = 1;
        }
        else if(bCount == 1){
          if(bulbClicked == 'bulb-2'){
            $('.collapse').collapse('hide');
            bCount = 0;
          }
          else{
            getLEDDdata(document.getElementById('bulb-2'));
          }
        }
        bulbClicked = 'bulb-2';
      });
      $('#bulb-3').on('click',function(){
        if(bCount == 0){
          $('.collapse').collapse('show');
          getLEDDdata(document.getElementById('bulb-3'));
          bCount = 1;
        }
        else if(bCount == 1){
          if(bulbClicked == 'bulb-3'){
            $('.collapse').collapse('hide');
            bCount = 0;
          }
          else{
            getLEDDdata(document.getElementById('bulb-3'));
          }
        }
        bulbClicked = 'bulb-3';
      });

      function toggleLEDPower(){
          //ledName = document.getElementById('light-name-id').innerHTML;
          button = document.getElementById('light-power');
          var ledName = document.getElementById('light-name-id').innerHTML;
          
          if (button.className == "btn btn-success"){
            //Power off the led all zeros
            socket.emit('toggle led', ledName.substring(5), 0, 0, 0);

            getLEDDdata(document.getElementById(ledName));
            button.className = "btn btn-danger";
            button.innerHTML = "Turn On to White";
            document.getElementById(ledName).setAttribute('style','fill: '+ 'rgb(0, 0, 0)' +';');
          }
          else{
            //power on led to white
            socket.emit('toggle led', ledName.substring(5), 255, 255, 255);
            socket.emit('power on');
            button.className = "btn btn-success";
            button.innerHTML = "Turn Off";
            document.getElementById(ledName).setAttribute('style','fill: '+ 'rgb(255, 255, 255)' +';');
          }

      }

      //Change the color of the bulb in sync with the website
      function getLEDDdata(bulbClicked) {
        ledName = bulbClicked.id;
        var wheeldropBGStyle = window.getComputedStyle(bulbClicked).getPropertyValue('fill');
        var label = document.getElementById('rgbtext');
        PWbutton = document.getElementById('light-power');
        label.textContent = b.style.background = wheeldropBGStyle;
        document.getElementById('light-name-id').innerHTML=ledName;
        

        if(label.textContent == 'rgb(0, 0, 0)'){
          PWbutton.className = "btn btn-danger";
          PWbutton.innerHTML = "Turn On";
          bulbClicked.setAttribute('style','fill: '+ 'rgb(0, 0, 0)' +';');
        }
        else{
          PWbutton.className = "btn btn-success";
          PWbutton.innerHTML = "Turn Off";
          //bulbClicked.setAttribute('style','fill: '+ 'rgb(255, 255, 255)' +';');
        }  
        

      };

      function resizeSVG(){
        console.log('Client Requested New Data');
        var width = ($(window).width());
        var all = document.getElementsByTagName('svg');
        for(var i = 0, max = all.length; i < max; i++)
        {
            if(width >= 1500){
              all[i].setAttribute('height', 300);
              console.log("MAX" + width);
            }
            else if(width < 1500 && width >= 1000){
              all[i].setAttribute('height', 250);
              console.log("MID" + width);
            }
            else if(width < 1000 && width >= 500){
              all[i].setAttribute('height', 200);
              console.log("LOW" + width);
            }
            else if(width < 500 && width > 400){
              all[i].setAttribute('height', 180);
              console.log("VLOW" + width);
            }
            else{
              all[i].setAttribute('height', 130);
              console.log("ELSE" + width);
            }
        }
      }
    </script>
    <script>
      $(function() {
          var $body = $(document);
          $body.bind('scroll', function() {
              // "Disable" the horizontal scroll.
              if ($body.scrollLeft() !== 0) {
                  $body.scrollLeft(0);
              }
          });
        });
    </script>
    <script src='1k.js'></script>
    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
  </body>
</html>
